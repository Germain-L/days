# https://taskfile.dev

version: '3'

includes:
  backend:
    taskfile: ./backend/Taskfile.yml
    dir: ./backend
  app:
    taskfile: ./app/Taskfile.yml
    dir: ./app
    aliases: [android]

vars:
  GREETING: Hello, World!

tasks:
  default:
    desc: Show available tasks
    cmds:
      - echo "{{.GREETING}}"
      - echo ""
      - echo "Available task namespaces:"
      - echo "  backend:* - Backend Go server tasks"
      - echo "  app:* (or android:*) - Android app tasks"
      - echo ""
      - echo "Common workflows:"
      - echo "  task backend:dev     - Run backend in development mode"
      - echo "  task app:dev         - Android development workflow"
      - echo "  task backend:test    - Run backend tests"
      - echo "  task app:test        - Run Android tests"
      - echo ""
      - echo "Use 'task --list' to see all available tasks"
    silent: true

  dev:
    desc: Start both backend and Android development
    deps:
      - backend:swagger
    cmds:
      - echo "Starting development environment..."
      - echo "Backend - http://localhost:8080"
      - echo "Swagger docs - http://localhost:8080/swagger/"
      - echo ""
      - echo "To run Android app:"
      - echo "  task app:dev"

  test:
    desc: Run all tests (backend + Android)
    cmds:
      - task: backend:test
      - task: app:test

  clean:
    desc: Clean all build artifacts
    cmds:
      - task: backend:clean
      - task: app:clean

  build:
    desc: Build both backend and Android app
    cmds:
      - task: backend:build
      - task: app:build
